# LERS Report Generator

Набор проектов для генерации отчётов из системы **ЛЭРС УЧЁТ** (система учёта энергоресурсов).

## Проекты

### LersReportGeneratorPlugin

WinForms плагин для АРМ оператора ЛЭРС.

**Возможности:**
- Генерация отчётов ОДПУ (общедомовые приборы учёта)
- Генерация отчётов ИПУ (индивидуальные приборы учёта)
- Работа с локальным и удалёнными серверами
- Массовая генерация со всех серверов
- Экспорт в PDF/XLSX
- Импорт/экспорт серверов с шифрованием паролей

**Установка:**
1. Распаковать архив
2. Открыть PowerShell в папке `LersReportGeneratorPlugin`
3. Запустить: `.\install.bat`
4. Перезапустить АРМ ЛЭРС
5. Плагин появится в меню: **Сервис → Генератор отчётов**

Скрипт автоматически соберёт проект и установит в `C:\Program Files\LERS\Client\Plugins\`

### LersReportProxy

Windows Service - прокси-служба для удалённых серверов ЛЭРС.

**Зачем нужна:**
- Расширяет REST API ЛЭРС (добавляет недостающие endpoints)
- Поддержка генерации ИПУ отчётов (не поддерживается в REST API)
- Получение отчётов точек одним запросом (вместо N запросов)

**Установка на сервере ЛЭРС:**
1. Распаковать архив на сервере
2. Открыть PowerShell от администратора в папке `LersReportProxy`
3. Запустить: `.\install.bat`
4. Служба будет установлена и запущена на порту **5377**

Скрипт автоматически соберёт и установит Windows Service.

### LersReportCommon

Общая библиотека для устранения дублирования кода между плагином и прокси-службой.

**Содержит:**
- `Logger.cs` - универсальный файловый логгер
- `ReflectionHelper.cs` - работа с reflection для ЛЭРС API
- `Constants.cs` - общие константы

## Системные требования

- Windows 10/11 или Windows Server 2016+
- .NET Framework 4.8
- .NET SDK 8.0 (для сборки)
- Установленный ЛЭРС УЧЁТ (для плагина)

## Документация

Детальная документация доступна в комментариях к коду и XML-комментариях в исходниках проектов.

## Лицензия

Проприетарное ПО. Все права защищены.

## О системе ЛЭРС УЧЁТ

**ЛЭРС УЧЁТ** - система учёта энергоресурсов (вода, тепло, электричество, газ).

Официальная документация: https://docs.lers.ru/
